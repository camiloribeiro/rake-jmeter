<!--
You are free to copy and use this sample in accordance with the terms of the
Apache license (http://www.apache.org/licenses/LICENSE-2.0.html)
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <title>Performance Report</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
      padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="../assets/ico/favicon.png">
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>

    <script type='text/javascript' src="data/data.js"></script>

    <script>
      var page = 0;
      function updatePage(newPage){
        page = newPage;
        updateTable();
      }

      function updateTable() {

        document.getElementById('page_name').innerHTML= name_resource[page];
        document.getElementById('project_name').innerHTML= project_name;

        var number_requests_data = google.visualization.arrayToDataTable(num_requests[page]);
        var response_time_data = google.visualization.arrayToDataTable(response_time[page]);
        var throughput_data = google.visualization.arrayToDataTable(throughput[page]);
        var error_data = google.visualization.arrayToDataTable(error_rate[page]);
        var percentile_data = google.visualization.arrayToDataTable(percentile[page]);
        var deviation_data = google.visualization.arrayToDataTable(deviation[page]);

        var options = {
          // title: 'kala',
          height: 500
          ,pointSize: 5
          ,width: 1200
          ,fontSize: 15
          ,lineWidth: 5
          ,series: {
            0:{color: 'black', areaOpacity: 0.3, lineWidth: 3}
            ,1:{color: 'red', areaOpacity: 0.3, lineWidth: 3}
            ,2:{color: 'purple', areaOpacity: 0.3, lineWidth: 3}
            ,3:{color: 'blue', areaOpacity: 0.3, lineWidth: 3}
            ,4:{color: 'orange', areaOpacity: 0.3, lineWidth: 3}
            ,5:{color: 'grey', areaOpacity: 0.3, lineWidth: 2}
            ,6:{color: 'Aquamarine', areaOpacity: 0.3, lineWidth: 3}
            ,7:{color: 'DarkGoldenRod', areaOpacity: 0.3, lineWidth: 3}
            ,8:{color: 'DeepPink', areaOpacity: 0.3, lineWidth: 3}
            ,9:{color: 'OrangeRed', areaOpacity: 0.3, lineWidth: 3}
            ,10:{color: 'MediumOrchid', areaOpacity: 0.3, lineWidth: 3}
            ,11:{color: 'Navy', areaOpacity: 0.3, lineWidth: 3}
            ,12:{color: 'YellowGreen', areaOpacity: 0.3, lineWidth: 3}
            ,13:{color: 'Tan', areaOpacity: 0.3, lineWidth: 3}
            ,14:{color: 'MediumVioletRed', areaOpacity: 0.3, lineWidth: 3}
          }
        };

        var number_requests_chart = new google.visualization.LineChart(document.getElementById('number_requests_1'));
        number_requests_chart.draw(number_requests_data, options);

        google.visualization.events.addListener(number_requests_chart, 'select', 
        (function (x) { return function () { AreaSelectHander(number_requests_chart, number_requests_data, options)}})(1));

        var response_time_chart = new google.visualization.LineChart(document.getElementById('response_time_1'));
        response_time_chart.draw(response_time_data, options);

        google.visualization.events.addListener(response_time_chart, 'select', 
        (function (x) { return function () { AreaSelectHander(response_time_chart, response_time_data, options)}})(1));

        var throughput_chart = new google.visualization.LineChart(document.getElementById('throughput_1'));
        throughput_chart.draw(throughput_data, options);

        google.visualization.events.addListener(throughput_chart, 'select', 
        (function (x) { return function () { AreaSelectHander(throughput_chart, throughput_data, options)}})(1));

        var error_chart = new google.visualization.LineChart(document.getElementById('error_1'));
        error_chart.draw(error_data, options);

        google.visualization.events.addListener(error_chart, 'select', 
        (function (x) { return function () { AreaSelectHander(error_chart, error_data, options)}})(1));

        var percentile_chart = new google.visualization.LineChart(document.getElementById('percentile_1'));
        percentile_chart.draw(percentile_data, options);

        google.visualization.events.addListener(percentile_chart, 'select', 
        (function (x) { return function () { AreaSelectHander(percentile_chart, percentile_data, options)}})(1));

        var deviation_chart = new google.visualization.LineChart(document.getElementById('deviation_1'));
        deviation_chart.draw(deviation_data, options);

        google.visualization.events.addListener(deviation_chart, 'select', 
        (function (x) { return function () { AreaSelectHander(deviation_chart, deviation_data, options)}})(1));
      }

      function AreaSelectHander(chart, gdata, options) {
        // when ever clicked we enter here 
        // more code needed to inspect what actually was clicked, now assuming people
        // play nicely and click only lables...
        var selection = chart.getSelection();       
        var view = new google.visualization.DataView(gdata);
        console.log(options);

        // click and data index are one off
        i = selection[0].column - 1;

        // just simple reverse
        if (options.series[i].lineWidth == 0) {
          options.series[i].lineWidth = 3;
          options.series[i].areaOpacity = 0.3;
        }
        else {
          options.series[i].lineWidth = 0;
          options.series[i].areaOpacity = 0.0;            
        }

        chart.draw(gdata, options);
      }
    </script>

    <script type='text/javascript'>
      google.load('visualization', '1', {packages:['table', 'corechart']});
      google.setOnLoadCallback(updateTable);
      </script>

    </head>

    <body>
      <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" id="project_name" href="#"></a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <script>
                  for (var i = 0; i < name_resource.length; i++) {
                   document.write("<li><a href='#' onclick='updatePage("+i+");'>"+name_resource[i]+"</a></li>");
                 }
                 </script>
              </ul>
            </div><!--/.nav-collapse -->
          </div>
        </div>
      </div>
      <div class="container">
        <div id='merchant_create_order'>
          <H1><div id="page_name"></div></H1>
          <div> 
            <h3>Requests Over Builds:</h3>
            <div id='number_requests_1'></div>
            <h3>Response Time changes over build:</h3>
            <div id='response_time_1'></div>
            <h3>Throughput over builds:</h3>
            <div id='throughput_1'></div>
            <h3>Performance Percentiles changes over builds:</h3>
            <h3>Error rate over builds:</h3>
            <div id='error_1'></div>
            <h3>Performance Percentiles changes over builds:</h3>
            <div id='percentile_1'></div>
            <h3>Deviation changes over builds:</h3>
            <div id='deviation_1'></div>
          </div>

        </div> <!-- /container -->

    </body>
